<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
</head>
<body>
<div id="app">
    <el-form id="searchFrom" label-width="80px">
        <el-form-item>
            名称<el-input  name="name" value=""></el-input>

            <el-button type="primary"  @click="cx">查询</el-button>
        </el-form-item>
    </el-form>
    <el-button-group>
        <el-button type="primary" icon="el-icon-edit" @click="add"></el-button>
        <el-button type="primary" icon="el-icon-share" @click="up"></el-button>
        <el-button type="primary" icon="el-icon-delete" @click="del"></el-button>
    </el-button-group>
    <el-table :data="tableData" @selection-change="changeFun">
        <el-table-column type="selection" prop="id" width="55"></el-table-column>

        <el-table-column prop="name" label="名称" width="180">
        </el-table-column>

    </el-table>
    <el-pagination
            @size-change="handleSizeChange"
            @current-change="handleCurrentChange"
            :current-page="currentPage4"
            :page-sizes="[10, 50, 100, 500]"
            :page-size="10"
            layout="total, sizes, prev, pager, next, jumper"
            :total="total">
    </el-pagination>
</div>
</body>
<script type="text/javascript" src="../../js/include.js"></script>
<script>

    new Vue({
        el: '#app',
        data: {
            tableData: [{
                name: '',
            }],
            total:0,
            currentPage4: 4,
            page: 1,
            rows:10,
            multipleSelection:[]
        } ,
        methods: {
            cx(){
                var obj=$("#searchFrom").serializeObject();
                obj.page= this.page
                obj.rows=this.rows
                var self = this;
                $.ajax({
                    url:url+"/system/role/list",
                    data:obj,
                    type:'post',
                    success:function(data){
                        self.tableData=data.data.rows;
                        self.total=data.data.total;
                    }
                });
            }, handleSizeChange(val) {
                this.rows=val
                this.cx()
            },handleCurrentChange(val) {
                this.page=val
                this.cx()
            },add(){
                window.location=htmlURL+"/system/role/add.html";
            },del(){

                var myArray=new Array();
                for(var i=0;i<this.multipleSelection.length;i++){
                    myArray.push(this.multipleSelection[i].id);
                }
                $.ajax({
                    url:url+'/system/role/delete',
                    type:'post',
                    data:"id="+myArray,
                    success:function(data){

                        if(data.result=="success"){
                            window.location=htmlURL+"/system/role/list.html";
                        }
                    }
                });
            },up(){
                window.location=htmlURL+"/system/role/update.html?id="+this.multipleSelection [0].id;
            },changeFun(val) {
                this.multipleSelection = val;
            }
        },
        mounted () {
            this.cx();
        }
    })

</script>
</html>